@using System.Linq.Expressions

<OutlinedTextField Label="@Label"
                   Value="@Value"
                   ValueChanged="OnInput"
                   For="@For"
                   FormatText="(99-9999999)"
                   MaxLength="10"
                   Visible="@Visible"
                   Disabled="@Disabled" />

@code {
    [Parameter] public string Label { get; set; } = "FEIN";
    [Parameter] public string? Value { get; set; }
    [Parameter] public EventCallback<string> ValueChanged { get; set; }
    [Parameter] public Expression<Func<string>>? For { get; set; }
    [Parameter] public bool Visible { get; set; }
    [Parameter] public bool Disabled { get; set; }

    private async Task OnInput(string? value)
    {
        var digits = new string((value ?? "").Where(char.IsDigit).ToArray());
        if (digits.Length > 9) digits = digits[..9];

        Value = digits.Length switch
        {
            > 2 => $"{digits[..2]}-{digits[2..]}",
            _ => digits
        };

        await ValueChanged.InvokeAsync(Value);
    }
}
